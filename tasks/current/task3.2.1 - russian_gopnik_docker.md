# Тема Работа с Docker и оптимизация образов. Задание 1. Поиск кринжа.

Вам, как закаленному нетраннеру из Химок, поручена задача — пробиться в древнюю базу данных корпорации **"Альтушечная"**, которая крутится на **PostgreSQL** в контейнере, собранном через Docker на Ubuntu.

Однако код, что вам прислали, был написан под кайфом джуном Владосом, который утверждает, что "оно у него на винде работало, че ты начинаешь".

У вас в руках только багнутый `Dockerfile`, который больше похож на письмо к Богу, чем на инструкцию. Но вы обязаны его починить и запустить, ведь только тогда вы сможете получить доступ к священной таблице `mne_etot_mir_absolyutno_ponyaten`, где скрыта истина: "Когда же выйдет Half-Life 3?".

## Условие задания

Исходный `Dockerfile`:
```
# Базовый образ Ubuntu
FROM alpine:latest

# Установить PostgreSQL
# Настроить PostgreSQL
RUN echo "POSTGRES_USER=postgres" > /etc/environment RUN echo "POSTGRES_PASSWORD=secret" > 
/etc/environment
RUN apt-get update && apt-get install -y postgresql

# Запустить PostgreSQL
CMD ["postgresql"]
```

1. Изучите синтаксис `Dockerfile`, найдите и исправьте ошибки в нем.
2. Соберите образ, для этого:
	- Выполните `docker build -t postgres2077 .` для сборки образа `postgres2077` с исправленным `Dockerfile`;
	- Проверьте журналы сборки (logs) и убедитесь, что все прошло без ошибок.
3. Запустите контейнер с открытым портом 5432 (порт PostgreSQL): `docker run -d -p 5432:5432 --name pg2077 postgres2077`.
4. Убедитесь, что PostgreSQL работает, для этого:
	- Подключитесь к PostgreSQL из консоли с помощью через `psql`;
	- Проверьте, что можно выполнять SQL-запросы.

## Советы

В багнутом `Dockerfile` обратите внимание на:
- Базовый образ;
- Корректность установки PostgreSQL;
- Правильность задания переменных окружения;
- Запуск без мата и `exit 1`.

Используйте документацию Docker [https://docs.docker.com/engine/reference/builder/](https://docs.docker.com/engine/reference/builder/) для помощи.

Имеет смысл изучить основные команды PostgreSQL (например, CREATE DATABASE, CREATE TABLE, INSERT, SELECT) для проверки работы базы данных.

## Цели по теме Работа с Docker и оптимизация образов

| Тема                                 | Применение                                                          |
| ------------------------------------ | ------------------------------------------------------------------- |
| Создание образа с помощью Dockerfile | Изучение структуры Dockerfile, основных инструкций                  |
| Запуск контейнера из образа          | Запуск контейнера из образа, собранного из исправленного Dockerfile |
| Передача переменных окружения        | Корректное задание переменных окружения                             |
| Проброс портов                       | Запуск контейнера с открытым портом 5432                            |

## Автоматическая проверка 

Обратите внимание на то, что будет проверяться автоматически:

1. Сборка образа.
2. Запуск контейнера.
3. Подключение к базе данных.


