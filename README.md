## Основы контейнеризации и архитектура Docker

**Цель:** Понять основные принципы контейнеризации, архитектуру Docker, научиться создавать, запускать и управлять контейнерами.

**1. Что такое контейнеризация:**

*   **Изоляция:** Контейнеры изолируют приложения и их зависимости друг от друга и от основной операционной системы.
*   **Переносимость:** Контейнеры обеспечивают переносимость приложений между разными средами (разработка, тестирование, продакшн).
*   **Легкость:** Контейнеры используют ресурсы основной операционной системы, что делает их более легкими и быстрыми, чем виртуальные машины.
*   **Воспроизводимость:** Контейнеры гарантируют, что приложение будет работать одинаково в любой среде, где установлен Docker.

**2. Сравнение с виртуальными машинами (VM):**

| Характеристика       | Контейнеры                                   | Виртуальные машины (VM)                       |
| -------------------- | --------------------------------------------- | ---------------------------------------------- |
| Операционная система | Общая для всех контейнеров                  | Каждая VM имеет свою собственную ОС              |
| Ресурсы             | Экономичное использование ресурсов             | Большое потребление ресурсов                   |
| Загрузка            | Быстрая загрузка                               | Более длительная загрузка                        |
| Размер               | Малый размер образа                             | Большой размер образа                           |
| Изоляция           | Изоляция на уровне процессов и файловой системы | Полная изоляция на уровне аппаратного обеспечения |

**3. Архитектура Docker:**

*   **Docker Engine:** Основной компонент Docker, состоящий из Docker Daemon и Docker CLI.
    *   **Docker Daemon (dockerd):** Фоновый процесс, управляющий контейнерами, образами, сетями и томами.
    *   **Docker CLI (docker):** Интерфейс командной строки для взаимодействия с Docker Daemon.
*   **Docker Hub:** Реестр образов Docker (public и private). Позволяет хранить и распространять образы.
*   **Docker Image (Образ):** Шаблон для создания контейнера. Содержит все необходимые файлы, библиотеки и зависимости для запуска приложения.
*   **Docker Container (Контейнер):** Запущенный экземпляр образа Docker.  Изолированное окружение для выполнения приложения.

**4. Основные понятия Docker:**

*   **Dockerfile:** Текстовый файл, содержащий инструкции для сборки образа Docker.
*   **Docker Compose:** Инструмент для определения и запуска многоконтейнерных приложений.
*   **Docker Network:** Виртуальная сеть, позволяющая контейнерам взаимодействовать друг с другом.
*   **Docker Volume:** Механизм для хранения данных, используемых контейнерами, вне файловой системы контейнера (для обеспечения сохранности данных при удалении контейнера).

**5. Основные команды Docker:**

*   **`docker version`:** Показать версию Docker.
*   **`docker info`:** Показать информацию о системе Docker.
*   **`docker images`:** Показать список локальных образов.
*   **`docker ps`:** Показать список запущенных контейнеров.
    *   `-a`: Показать все контейнеры (включая остановленные).
*   **`docker run <опции> <образ>:<тег> <команда>`:** Запустить контейнер из образа.
    *   `-d`: Запустить контейнер в фоновом режиме (detached mode).
    *   `-p <порт_хоста>:<порт_контейнера>`: Пробросить порт с хоста в контейнер.
    *   `-v <путь_хоста>:<путь_контейнера>`: Примонтировать том с хоста в контейнер.
    *   `--name <имя>`: Задать имя контейнеру.
    *   `-e <переменная>=<значение>`: Установить переменную окружения.
*   **`docker stop <контейнер>`:** Остановить запущенный контейнер.
*   **`docker start <контейнер>`:** Запустить остановленный контейнер.
*   **`docker restart <контейнер>`:** Перезапустить контейнер.
*   **`docker rm <контейнер>`:** Удалить остановленный контейнер.
    *   `-f`: Принудительно удалить запущенный контейнер.
*   **`docker rmi <образ>`:** Удалить образ.
*   **`docker build <путь_к_Dockerfile>`:** Собрать образ из Dockerfile.
    *   `-t <имя>:<тег>`: Задать имя и тег образу.
*   **`docker pull <образ>:<тег>`:** Скачать образ из Docker Hub.
*   **`docker push <имя>:<тег>`:** Загрузить образ в Docker Hub.
*   **`docker exec -it <контейнер> <команда>`:** Выполнить команду в запущенном контейнере.
    *   `-it`: Интерактивный режим с терминалом.
*   **`docker logs <контейнер>`:** Показать логи контейнера.
*   **`docker network ls`:** Показать список сетей Docker.
*   **`docker volume ls`:** Показать список томов Docker.

**6. Создание Dockerfile:**

*   `FROM <образ_основа>`: Указать базовый образ, на основе которого будет строиться новый образ.
*   `MAINTAINER <имя>`: Указать имя автора образа.
*   `RUN <команда>`: Выполнить команду в процессе сборки образа.
*   `COPY <источник> <назначение>`: Скопировать файлы из локальной файловой системы в образ.
*   `ADD <источник> <назначение>`: Скопировать файлы (поддерживает URL и распаковку архивов) в образ.
*   `WORKDIR <путь>`: Установить рабочую директорию.
*   `EXPOSE <порт>`: Указать порт, который будет прослушиваться приложением в контейнере.
*   `ENV <переменная>=<значение>`: Установить переменную окружения.
*   `CMD <команда>`: Указать команду, которая будет выполняться при запуске контейнера.  Может быть переопределена при запуске контейнера.
*   `ENTRYPOINT <команда>`: Указать команду, которая всегда будет выполняться при запуске контейнера.  Не может быть переопределена, но можно добавить аргументы.
*   `VOLUME <путь>`: Создать том для хранения данных.

**Пример Dockerfile:**

```dockerfile
FROM ubuntu:latest
MAINTAINER Your Name

RUN apt-get update && apt-get install -y nginx

COPY index.html /var/www/html/

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
