# Course dev - DNS - Sasha 


DNS (Domain Name System) — это система доменных имён, которая позволяет сопоставлять домены сайтов с IP-адресами, необходимыми, чтобы подключать устройства к серверам в сети, система, которая преобразует удобные для человека названия сайтов (например, google.com) в IP-адреса (например, 142.250.185.206), понятные компьютерам.
Проблема, которую решает DNS, — неудобство запоминания индивидуальных адресов, которые присваиваются любому устройству. Система DNS автоматически конвертирует домены в IP.  

Некоторые другие задачи DNS:


•	Доступность новых сайтов. DNS нужен, чтобы новый сайт был доступен всем пользователям интернета, а не только его владельцу.  
•	Ускорение доступа. Серверы используют кэширование, чтобы быстрее находить популярные запросы, — запрос обрабатывается сразу, без необходимости повторного обращения к серверу.  
•	Маршрутизация. Направляет запросы к ближайшему доступному серверу, что увеличивает скорость загрузки и снижает нагрузку на сеть.  
•	Фильтрация. Может защитить от DNS-спуфинга, чтобы обеспечить безопасность данных пользователя.


Иерархия DNS включает несколько уровней:


1.	Корневые серверы: Эти серверы являются начальной точкой для всех DNS-запросов, содержат информацию о доменах верхнего уровня (TLD) и направляют запросы к соответствующим серверам.
   
2.	Домен верхнего уровня (TLD): под корневыми серверами находятся сервера доменов верхнего уровня (TLD), таких как .com, .net, .org, .ru и другие. Эти сервера управляют определенными доменными зонами. Например, сервер для домена .com знает, какие авторитетные серверы управляют доменами второго уровня в зоне .com. Серверы TLD обеспечивают организацию и управление доменами верхнего уровня и направляют запросы к авторитетным серверам, которые содержат детальную информацию о доменах второго уровня.
   
3.	Авторитетные серверы: Эти серверы содержат информацию о конкретных доменах и отвечают на запросы о них. Например, авторитетный сервер для example.com содержит записи, которые указывают на IP-адреса, связанные с этим доменом. Авторитетные серверы предоставляют окончательную информацию, необходимую для завершения DNS-запроса.
   
4.	Рекурсивные резолверы: резолвер - компонент системы DNS, который служит посредником между конечным пользователем и сетью DNS-серверов, обеспечивая преобразование доменных имен в IP-адреса. Когда пользователь вводит адрес веб-сайта в браузере или запускает приложение, которое требует доступа к интернет-ресурсам, запрос на преобразование доменного имени в IP-адрес отправляется именно рекурсивному резолверу. Резолверы получают запросы от пользователей и выполняют весь процесс поиска нужной информации, обращаясь к другим DNS-серверам. Начинают они с корневых серверов, затем обращаются к серверам TLD и авторитетным серверам, пока не найдут нужный IP-адрес. Рекурсивные резолверы часто предоставляются интернет-провайдерами (ISP) или публичными сервисами, такими как Google Public DNS или Cloudflare DNS. Они кешируют ответы на определённое время, чтобы ускорить последующие запросы к тому же доменному имени.






FQDN (Fully Qualified Domain Name) или полное доменное имя — это полный адрес компьютера или интернет-хостинга в системе доменных имён (DNS).   
FQDN представляет собой уникальную текстовую метку, которая позволяет однозначно идентифицировать ресурс в глобальной сети.   

Особенности FQDN:

•	Включает в себя имена всех родительских доменов иерархии DNS, в том числе и корневого.  

•	Завершается точкой, указывающей корень иерархии DNS.  

•	Максимальный размер FQDN — 255 байт, с ограничением в 63 байта на каждое имя домена.  
Пример FQDN: «mail.google.com.»







Доменное имя состоит из нескольких уровней, которые отделены друг от друга точками. Уровни определяют иерархическое место домена в системе доменных имён (DNS):


1.	Нулевой уровень (корневой домен) — невидимая часть в конце любого доменного имени. Он является основой, с которой начинаются все остальные уровни доменов.
   
2.	Первый уровень (доменная зона, домен верхнего уровня) — последняя часть адреса, которая идёт после точки (например, .com или .ru). Делится на два основных типа:
   
o	Географические — национальные домены верхнего уровня (ccTLD). Для них используют лишь две буквы с учётом международного кода страны. Например, .eu — Евросоюз, .ru — Россия.  
o	Тематические — общие домены верхнего уровня (gTLD). Теоретически, они обозначают тематику сайта. К примеру, .com — коммерция, .military — военный, .gov — правительственный.

3.	Второй уровень (основной домен) — уникальное название сайта внутри домена верхнего уровня. Например, в адресе vk.com домен второго уровня — vk.
    
4.	Третий уровень (поддомен) — используется для создания отдельных частей сайта, таких как блоги, региональные или мобильные версии сайтов. Пример: в адресе docs.google.com домен третьего уровня — docs.  





Существуют следующие типы DNS-серверов:


1.	Локальные DNS-серверы. Как правило, принадлежат интернет-провайдеру или корпоративной сети. Обрабатывают запросы пользователей и кэшируют их, чтобы ускорить загрузку страниц.
   
2.	Корневые DNS-серверы. Хранят информацию о том, где размещены домены верхнего уровня. Это ключевые точки маршрутизации, которые регулируют работу всей системы DNS и перенаправляют запросы на сервер соответствующей доменной зоны.
   
3.	Серверы доменных зон. Хранят информацию об определённых доменных зонах и являются промежуточным звеном между корневым и авторитетным сервером.
   
4.	Авторитетные серверы. Предоставляют пользователю финальные данные о домене и его IP.
   
5.	Динамические DNS-серверы. Обновляют информацию о доменах на вверенном им участке сети почти мгновенно.
   
6.	Ведущие (Master) и ведомые (Slave). Ведущие берут информацию о доменах со своего диска, а ведомые — у соседнего сервера. 





DNS-зона - 

Файл или база данных, содержащая DNS-записи для определённого домена (например, example.com). Управляется авторитативными серверами.
  
Пример зоны:


example.com.       IN  A                    192.0.2.1  
www                          IN  CNAME       example.com.













Некоторые основные типы DNS-записей и их функции:


1.	A-запись. Преобразует доменное имя в IPv4-адрес. 
2.	AAAA-запись. Преобразует доменное имя в IPv6-адрес. 
3.	CNAME-запись. Указывает на другое доменное имя. Это позволяет использовать одно доменное имя для указания на другое, что упрощает управление доменами.  
4.	MX-запись. Указывает на почтовый сервер для домена. Это необходимо для правильной маршрутизации электронной почты.  
5.	TXT-запись. Содержит текстовую информацию, часто используется для верификации домена. Например, для подтверждения владения доменом при настройке сервисов.  
6.	SRV-записи. Используются для указания на определённые сервисы. Обычно SRV указывает на местоположение серверов, а также номер порта и имя хоста.  
7.	PTR-записи. Используются для обратного разрешения IP-адресов в доменные имена. Помогают при фильтрации почты.  
8.	SOA-запись. Начальная запись зоны, которая указывает, на каком сервере хранится эталонная информация о доменном имени. SOA-запись домена критически важна для работы службы DNS.














Процесс разрешения домена в системе доменных имён (DNS) включает несколько этапов:


1.	Локальный поиск DNS. Когда пользователь вводит доменное имя в веб-браузере, его компьютер проверяет локальный кэш DNS, чтобы увидеть, есть ли у него уже соответствующий IP-адрес. Если IP-адрес найден, браузер может немедленно установить соединение с веб-сайтом.  
2.	Рекурсивный DNS-запрос. Компьютер пользователя отправляет рекурсивный запрос DNS-серверу распознавателя, если IP-адрес не находится в локальной кэш-памяти.  
3.	Поиск TLD (DNS-серверов домена верхнего уровня). Корневой DNS-сервер возвращает IP-адрес DNS-сервера TLD, ответственного за TLD запрашиваемого домена.  
4.	Поиск авторитетного DNS-сервера. Сервер TLD возвращает IP-адрес авторизованного DNS-сервера для требуемого домена серверу-преобразователю.  
5.	Получение ответа и кэширование. Авторитетный DNS-сервер отправляет ответ обратно локальному DNS-серверу. Локальный DNS-сервер кэширует этот ответ, чтобы при необходимости быстро отвечать на будущие запросы для того же домена.  
6.	Ответ компьютеру. Получив IP-адрес от локального DNS-сервера, компьютер может использовать этот IP-адрес для установления соединения с сервером, связанным с запрашиваемым доменным именем.












Инструменты для работы с DNS в Linux


•	dig – просмотр DNS-записей:

dig example.com A



•	nslookup – проверка разрешения имён:

nslookup example.com



•	host – аналогично nslookup:

host example.com





DNS работает по протоколам TCP (Transmission Control Protocol) и UDP (User Datagram Protocol) на транспортном уровне.   

Для большинства DNS-запросов используется UDP, так как он обеспечивает быструю и эффективную передачу данных без установления соединения. 


Для более крупных запросов или зоновых передач (zone transfers) используется TCP, так как он обеспечивает надёжность и гарантирует доставку всех пакетов данных.








